--I need total Population in zipcode 94085 (Sunnyvale CA)
SELECT
  SUM(population) AS total_population 
FROM
  bigquery-public-data.census_bureau_usa.population_by_zip_2010 WHERE zipcode = '94085';
--I need number of Male and Female head count in zipcode 94085 (Sunnyvale CA)
SELECT
  SUM(CASE WHEN gender = 'Male' THEN population ELSE 0 END) AS male_population,
  SUM(CASE WHEN gender = 'Female' THEN population ELSE 0 END) AS female_population 
FROM
  bigquery-public-data.census_bureau_usa.population_by_zip_2010 WHERE zipcode = '94085';
--I want which Age group has max headcount for both male and female genders combine (zipcode 94085 (Sunnyvale CA))
SELECT 
  CONCAT(CAST(minimum_age AS STRING), '-', CAST(maximum_age AS STRING)) AS age_group,
  SUM(population) AS total_population
FROM 
  bigquery-public-data.census_bureau_usa.population_by_zip_2010
WHERE 
  zipcode = '94085'
GROUP BY age_group
ORDER BY total_population DESC;
--I want age group for male gender which has max male population zipcode 94085 (Sunnyvale CA))
SELECT
  CONCAT(CAST(minimum_age AS STRING), '-', CAST(maximum_age AS STRING)) AS age_group,
  SUM(population) AS male_population
FROM
  bigquery-public-data.census_bureau_usa.population_by_zip_2010
WHERE
  zipcode = '94085' 
  AND LOWER(gender) = 'male'  -- Using LOWER to ensure case insensitivity
  AND minimum_age IS NOT NULL -- Ensuring valid minimum_age
  AND maximum_age IS NOT NULL -- Ensuring valid maximum_age
GROUP BY age_group
ORDER BY male_population DESC
LIMIT 1;
--I want age group for female gender which has max male population zipcode 94085 (Sunnyvale CA))
SELECT
  CONCAT(CAST(minimum_age AS STRING), '-', CAST(maximum_age AS STRING)) AS age_group,
  SUM(population) AS female_population
FROM
  bigquery-public-data.census_bureau_usa.population_by_zip_2010
WHERE
  zipcode = '94085' 
  AND LOWER(gender) = 'female'  -- Using LOWER to ensure case insensitivity
  AND minimum_age IS NOT NULL -- Ensuring valid minimum_age
  AND maximum_age IS NOT NULL -- Ensuring valid maximum_age
GROUP BY age_group
ORDER BY female_population DESC
LIMIT 1;
--I want zipcode which has highest male and female population in USA
SELECT 
  zipcode,
  SUM(CASE WHEN LOWER(gender) = 'male' THEN population ELSE 0 END) AS male_population,
  SUM(CASE WHEN LOWER(gender) = 'female' THEN population ELSE 0 END) AS female_population,
  SUM(population) AS total_population
FROM 
  bigquery-public-data.census_bureau_usa.population_by_zip_2010
GROUP BY zipcode
ORDER BY total_population DESC;
--I want first five age groups which has highest male and female population in USA
SELECT 
  CONCAT(CAST(minimum_age AS STRING), '-', CAST(maximum_age AS STRING)) AS age_group,
  SUM(CASE WHEN LOWER(gender) = 'male' THEN population ELSE 0 END) AS male_population,
  SUM(CASE WHEN LOWER(gender) = 'female' THEN population ELSE 0 END) AS female_population,
  SUM(population) AS total_population
FROM 
  bigquery-public-data.census_bureau_usa.population_by_zip_2010
GROUP BY age_group
ORDER BY total_population DESC
LIMIT 5;
--I want first five zipcodes which has highest female population in entire USA
SELECT 
  zipcode,
  SUM(CASE WHEN LOWER(gender) = 'female' THEN population ELSE 0 END) AS female_population
FROM 
  bigquery-public-data.census_bureau_usa.population_by_zip_2010
GROUP BY zipcode
ORDER BY female_population DESC
LIMIT 5;
--I want first 10 which has lowest male population in entire USA
SELECT 
  zipcode,
  SUM(CASE WHEN LOWER(gender) = 'male' THEN population ELSE 0 END) AS male_population
FROM 
  bigquery-public-data.census_bureau_usa.population_by_zip_2010
GROUP BY zipcode
ORDER BY male_population ASC
LIMIT 10;
